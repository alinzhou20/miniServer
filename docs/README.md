# 极简课堂实时通信后端

## 1. 概述
一个部署在教师端电脑（Windows 为主）的极简实时通信后端，专为校园内网环境设计，支持约100台学生设备同时连接，提供教师-学生双向实时消息传输与课堂管理功能。

**核心特性：**
- 🚀 **极简设计**：握手验证、无JWT、纯 Socket.IO 通信
- ⚡ **高性能**：内存连接管理，支持100+并发连接
- 🏫 **局域网优化**：专为校园内网环境优化，无公网依赖
- 📱 **实时通信**：毫秒级消息传输，支持广播和点对点

## 2. 功能特性

### 2.1 连接管理
- **握手验证**：连接时携带用户信息，后端校验后建立连接
- **自动房间分配**：根据角色和学号自动加入相应房间
- **实时状态监控**：用户上线/下线状态实时推送

### 2.2 教师功能
- **课堂控制**：向所有学生或特定学生/小组广播消息
- **实时监控**：查看学生连接状态和活动情况
- **作业收集**：实时接收学生提交的作业数据

### 2.3 学生功能
- **作业提交**：向教师提交作业数据和学习成果
- **小组协作**：与同组学生进行实时交流
- **状态同步**：学习进度和状态实时同步给教师

## 3. 极简架构

### 3.1 通信层
- **Fastify**：极简 HTTP 服务器，仅用于承载 Socket.IO
- **Socket.IO**：核心实时通信服务，处理所有客户端交互
- **命名空间**：`/classroom` 统一管理所有连接

### 3.2 服务层
- 鉴权：学生根据小组号、学号登录；教师根据账号密码登录；
- 调用AI：调用AI接口进行动态分析；
- 持久化：将数据持久化到数据库；

### 3.3 数据层
- **SQLite**：轻量级数据库，存储学生信息和课程数据
- **最小写入**：避免频繁数据库操作，优化并发性能
- **连接记录**：仅记录必要的连接信息，无实时状态更新

## 4. 技术栈

| 依赖 | 版本 | 作用 | 优化说明 |
|---|---|---|---|
| **Node.js** | 20+ | JavaScript 运行时 | LTS 版本，稳定性能 |
| **TypeScript** | 最新 | 类型安全开发 | 严格模式，提升代码质量 |
| **pnpm** | 最新 | 包管理器 | 快速安装，节省磁盘空间 |
| **Fastify** | 4.x | 极简 HTTP 服务器 | 仅承载 Socket.IO，无插件 |
| **Socket.IO** | 4.x | 实时通信核心 | 命名空间 `/classroom` |
| **better-sqlite3** | 最新 | 轻量数据库 | 同步操作，高性能 |
| **dotenv** | 最新 | 环境配置 | 开发环境配置加载 |

## 5. 相关文档

- [Socket.IO 通信协议](./API.md) - 详细的事件和消息格式说明
- [数据库设计](./DataBase.md) - SQLite 数据库结构和设计

---

**项目特点：极简、高效、专为教育场景优化** 🎓
