# 后端设计文档（中文）

## 1. 概述
一个部署在教师端电脑（Windows 为主）的轻量级教学活动管理后端，为信息科技课堂提供实时通信、数据处理与持久化的服务。

## 2. 功能

### 2.1 基础
- 用户登录：学生根据小组号、学号登录；教师根据账号密码登录；
- 连接通信：登录时与后端建立连接，后续通过连接进行实时通信；

### 2.2 教师
- 控制课堂：能够向所有学生发送控制信息；
- 接收作业：能够接收学生提交的作业数据；

### 2.3 学生
- 提交作业：能够提交作业数据；
- 动态分析：调用AI接口进行动态分析；

## 3. 架构

### 3.1 通信层

- Fastify：HTTP 服务，用于基础常规的请求响应；
- SocketIO：实时通信服务，用于指定目标的课堂双向通信；

### 3.2 业务层
- 鉴权：学生根据小组号、学号登录；教师根据账号密码登录；
- 调用AI：调用AI接口进行动态分析；
- 持久化：将数据持久化到数据库；

### 3.3 数据层（SQLite）

## 3. 依赖

| 依赖 | 类型 | 作用 | 备注 |
|---|---|---|---|
| Node.js 20+ | 运行时 | 现代 JS 运行时，稳定计时器与良好性能，满足 LAN 课堂规模 | 建议使用 LTS |
| TypeScript | 语言 | 提供类型安全，提升开发体验 | 建议开启 strict 模式 |
| pnpm | 包管理器 | 更快且节省磁盘空间的依赖安装 | 使用 lockfile 保证可复现 |
| Fastify | Web 框架 | HTTP 服务、路由、与 Schema 集成 | 使用官方 CORS/限流/JWT 插件 |
| Socket.IO | 实时通信 | 双向实时事件、房间/命名空间 | 命名空间 `/classroom`；支持重连 |
| better-sqlite3 | 数据库驱动 | 高性能同步 SQLite 访问 | 相比 `sqlite3` 更简洁高效 |
| dotenv | 配置（开发） | 本地加载 `.env` | 生产环境建议使用系统环境变量 |
